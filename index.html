<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>File Download Portal</title>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700;800&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
  *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --blue-deep:    #0a4f8c;
    --blue-mid:     #1a6fbd;
    --blue-light:   #3b9ede;
    --blue-pale:    #e8f4fd;
    --green-deep:   #0d7a55;
    --green-mid:    #1aa876;
    --green-light:  #2dd4a0;
    --green-pale:   #e6faf4;
    --white:        #ffffff;
    --off-white:    #f5faff;
    --text-dark:    #0d2137;
    --text-mid:     #2f5373;
    --text-soft:    #6a94b8;
    --border:       rgba(58, 158, 222, 0.18);
    --shadow-blue:  rgba(26, 111, 189, 0.15);
    --shadow-green: rgba(26, 168, 118, 0.18);
  }

  html { scroll-behavior: smooth; }

  body {
    font-family: 'Sora', sans-serif;
    background: var(--off-white);
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px;
    position: relative;
    overflow: hidden;
  }

  /* â”€â”€ Animated Background â”€â”€ */
  .bg-canvas {
    position: fixed;
    inset: 0;
    z-index: 0;
    overflow: hidden;
    pointer-events: none;
  }

  .bg-orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px);
    opacity: 0.35;
    animation: orbFloat linear infinite;
  }

  .bg-orb-1 {
    width: 520px; height: 520px;
    background: radial-gradient(circle, #3b9ede 0%, transparent 70%);
    top: -180px; left: -120px;
    animation-duration: 18s;
    animation-name: orbFloat1;
  }

  .bg-orb-2 {
    width: 400px; height: 400px;
    background: radial-gradient(circle, #2dd4a0 0%, transparent 70%);
    bottom: -140px; right: -100px;
    animation-duration: 22s;
    animation-name: orbFloat2;
  }

  .bg-orb-3 {
    width: 280px; height: 280px;
    background: radial-gradient(circle, #1a6fbd 0%, transparent 70%);
    top: 50%; right: 10%;
    animation-duration: 26s;
    animation-name: orbFloat3;
    opacity: 0.2;
  }

  @keyframes orbFloat1 {
    0%,100% { transform: translate(0,0) scale(1); }
    33%      { transform: translate(40px, 30px) scale(1.05); }
    66%      { transform: translate(-20px, 50px) scale(0.97); }
  }
  @keyframes orbFloat2 {
    0%,100% { transform: translate(0,0) scale(1); }
    40%      { transform: translate(-50px, -30px) scale(1.08); }
    70%      { transform: translate(20px, -60px) scale(0.95); }
  }
  @keyframes orbFloat3 {
    0%,100% { transform: translate(0,0); }
    50%      { transform: translate(-30px, 40px); }
  }

  /* Grid dots pattern */
  .bg-grid {
    position: fixed;
    inset: 0;
    z-index: 0;
    background-image:
      radial-gradient(circle, rgba(26,111,189,0.12) 1px, transparent 1px);
    background-size: 36px 36px;
    pointer-events: none;
  }

  /* â”€â”€ Main Card â”€â”€ */
  .card {
    position: relative;
    z-index: 10;
    background: rgba(255,255,255,0.82);
    backdrop-filter: blur(28px);
    -webkit-backdrop-filter: blur(28px);
    border: 1px solid rgba(58,158,222,0.22);
    border-radius: 32px;
    padding: 56px 48px 48px;
    width: 100%;
    max-width: 500px;
    box-shadow:
      0 4px 24px var(--shadow-blue),
      0 1px 0 rgba(255,255,255,0.9) inset,
      0 -1px 0 rgba(58,158,222,0.1) inset;
    animation: cardIn 0.7s cubic-bezier(0.22,1,0.36,1) both;
  }

  @keyframes cardIn {
    from { opacity: 0; transform: translateY(32px) scale(0.97); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  /* Top accent bar */
  .card::before {
    content: '';
    position: absolute;
    top: 0; left: 48px; right: 48px;
    height: 3px;
    background: linear-gradient(90deg, var(--blue-mid), var(--green-light), var(--blue-light));
    border-radius: 0 0 4px 4px;
    background-size: 200% 100%;
    animation: gradientShift 4s ease infinite;
  }

  @keyframes gradientShift {
    0%,100% { background-position: 0% 50%; }
    50%      { background-position: 100% 50%; }
  }

  /* â”€â”€ Header â”€â”€ */
  .header { text-align: center; margin-bottom: 40px; }

  .logo-wrap {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 80px; height: 80px;
    background: linear-gradient(135deg, var(--blue-mid) 0%, var(--green-mid) 100%);
    border-radius: 24px;
    margin-bottom: 20px;
    box-shadow: 0 8px 32px var(--shadow-blue), 0 2px 8px rgba(0,0,0,0.08);
    animation: logoPulse 3s ease-in-out infinite;
    position: relative;
    overflow: hidden;
  }

  .logo-wrap::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 60%);
  }

  @keyframes logoPulse {
    0%,100% { box-shadow: 0 8px 32px var(--shadow-blue), 0 2px 8px rgba(0,0,0,0.08); }
    50%      { box-shadow: 0 12px 40px rgba(26,168,118,0.25), 0 2px 8px rgba(0,0,0,0.08); }
  }

  .logo-svg { width: 38px; height: 38px; position: relative; z-index: 1; }

  h1 {
    color: var(--text-dark);
    font-size: 28px;
    font-weight: 800;
    letter-spacing: -0.8px;
    margin-bottom: 8px;
    line-height: 1.2;
  }

  .subtitle {
    color: var(--text-soft);
    font-size: 14px;
    font-weight: 400;
    line-height: 1.6;
  }

  /* â”€â”€ Divider â”€â”€ */
  .divider {
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--border), transparent);
    margin: 0 0 32px;
  }

  /* â”€â”€ Form â”€â”€ */
  .form-group { margin-bottom: 20px; }

  label {
    display: flex;
    align-items: center;
    gap: 6px;
    color: var(--text-mid);
    font-size: 11px;
    font-weight: 700;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 1.2px;
  }

  .label-dot {
    width: 6px; height: 6px;
    background: linear-gradient(135deg, var(--blue-mid), var(--green-mid));
    border-radius: 50%;
  }

  .input-wrap { position: relative; }

  .input-icon {
    position: absolute;
    left: 16px; top: 50%;
    transform: translateY(-50%);
    color: var(--text-soft);
    font-size: 18px;
    pointer-events: none;
    transition: color 0.2s;
  }

  input[type="text"] {
    width: 100%;
    padding: 15px 18px 15px 48px;
    background: var(--white);
    border: 1.5px solid var(--border);
    border-radius: 16px;
    color: var(--text-dark);
    font-family: 'DM Mono', monospace;
    font-size: 16px;
    font-weight: 500;
    letter-spacing: 2px;
    transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
    outline: none;
    box-shadow: 0 2px 8px rgba(26,111,189,0.06);
  }

  input[type="text"]::placeholder {
    color: var(--text-soft);
    opacity: 0.6;
    letter-spacing: 1px;
    font-weight: 400;
  }

  input[type="text"]:focus {
    border-color: var(--blue-light);
    box-shadow: 0 0 0 4px rgba(59,158,222,0.12), 0 2px 8px rgba(26,111,189,0.08);
    background: var(--white);
  }

  input[type="text"]:focus + .input-focus-bar { width: 100%; }

  input[type="text"].error-state {
    border-color: #ef4444;
    box-shadow: 0 0 0 4px rgba(239,68,68,0.1);
  }

  /* â”€â”€ Search Button â”€â”€ */
  .btn {
    width: 100%;
    padding: 16px 24px;
    background: linear-gradient(135deg, var(--blue-mid) 0%, var(--blue-deep) 100%);
    border: none;
    border-radius: 16px;
    color: var(--white);
    font-family: 'Sora', sans-serif;
    font-size: 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    position: relative;
    overflow: hidden;
    box-shadow: 0 4px 16px var(--shadow-blue);
    letter-spacing: 0.3px;
  }

  .btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.15) 0%, transparent 60%);
    opacity: 0;
    transition: opacity 0.3s;
  }

  .btn:hover:not(:disabled)::before { opacity: 1; }

  .btn::after {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    width: 0; height: 0;
    background: rgba(255,255,255,0.2);
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s, opacity 0.6s;
    opacity: 0;
  }

  .btn:active::after {
    width: 300px; height: 300px;
    opacity: 0;
    transition: 0s;
  }

  .btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 28px rgba(26,111,189,0.3);
    background: linear-gradient(135deg, var(--blue-light) 0%, var(--blue-mid) 100%);
  }

  .btn:active:not(:disabled) { transform: translateY(0); }
  .btn:disabled { opacity: 0.6; cursor: not-allowed; }

  .spinner {
    width: 18px; height: 18px;
    border: 2.5px solid rgba(255,255,255,0.35);
    border-top-color: #fff;
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
    display: none;
    flex-shrink: 0;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  /* â”€â”€ Notifications â”€â”€ */
  .notif {
    display: none;
    padding: 14px 18px;
    border-radius: 14px;
    font-size: 13.5px;
    font-weight: 500;
    margin-top: 16px;
    line-height: 1.5;
    animation: notifIn 0.35s cubic-bezier(0.22,1,0.36,1) both;
  }

  @keyframes notifIn {
    from { opacity: 0; transform: translateY(-10px) scale(0.98); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .notif.error {
    background: #fff5f5;
    border: 1px solid rgba(239,68,68,0.2);
    color: #c53030;
  }

  .notif.success {
    background: var(--green-pale);
    border: 1px solid rgba(26,168,118,0.25);
    color: var(--green-deep);
  }

  /* â”€â”€ Download Card â”€â”€ */
  .dl-card {
    display: none;
    margin-top: 20px;
    background: linear-gradient(135deg, var(--blue-pale) 0%, var(--green-pale) 100%);
    border: 1px solid rgba(58,158,222,0.2);
    border-radius: 20px;
    padding: 28px 24px;
    text-align: center;
    animation: notifIn 0.4s cubic-bezier(0.22,1,0.36,1) both;
    position: relative;
    overflow: hidden;
  }

  .dl-card::before {
    content: '';
    position: absolute;
    top: -40px; right: -40px;
    width: 120px; height: 120px;
    background: radial-gradient(circle, rgba(45,212,160,0.2) 0%, transparent 70%);
    border-radius: 50%;
  }

  .dl-card::after {
    content: '';
    position: absolute;
    bottom: -30px; left: -30px;
    width: 100px; height: 100px;
    background: radial-gradient(circle, rgba(59,158,222,0.15) 0%, transparent 70%);
    border-radius: 50%;
  }

  .file-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 60px; height: 60px;
    background: linear-gradient(135deg, var(--white) 0%, var(--blue-pale) 100%);
    border-radius: 16px;
    margin-bottom: 14px;
    box-shadow: 0 4px 16px var(--shadow-blue);
    font-size: 28px;
    position: relative;
    z-index: 1;
    animation: badgeBounce 0.6s cubic-bezier(0.22,1,0.36,1) 0.2s both;
  }

  @keyframes badgeBounce {
    from { transform: scale(0.5) rotate(-10deg); opacity: 0; }
    to   { transform: scale(1) rotate(0deg); opacity: 1; }
  }

  .dl-file-name {
    color: var(--text-dark);
    font-family: 'DM Mono', monospace;
    font-size: 17px;
    font-weight: 500;
    letter-spacing: 1px;
    margin-bottom: 4px;
    position: relative; z-index: 1;
  }

  .dl-file-sub {
    color: var(--text-soft);
    font-size: 12px;
    margin-bottom: 20px;
    position: relative; z-index: 1;
  }

  .btn-dl {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 13px 32px;
    background: linear-gradient(135deg, var(--green-mid) 0%, var(--green-deep) 100%);
    border: none;
    border-radius: 12px;
    color: var(--white);
    font-family: 'Sora', sans-serif;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.25s cubic-bezier(0.4,0,0.2,1);
    box-shadow: 0 4px 16px var(--shadow-green);
    position: relative; z-index: 1;
    letter-spacing: 0.3px;
  }

  .btn-dl:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(26,168,118,0.35);
    background: linear-gradient(135deg, var(--green-light) 0%, var(--green-mid) 100%);
  }

  .btn-dl:active { transform: translateY(0); }

  /* â”€â”€ Status Steps â”€â”€ */
  .steps {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 24px;
    margin-bottom: -4px;
  }

  .step {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--text-soft);
    font-weight: 500;
  }

  .step-dot {
    width: 8px; height: 8px;
    border-radius: 50%;
    background: var(--border);
    transition: all 0.4s;
  }

  .step.active .step-dot {
    background: linear-gradient(135deg, var(--blue-mid), var(--green-mid));
    box-shadow: 0 0 0 3px rgba(59,158,222,0.2);
    animation: dotPulse 1.5s ease-in-out infinite;
  }

  .step.done .step-dot {
    background: var(--green-mid);
  }

  @keyframes dotPulse {
    0%,100% { box-shadow: 0 0 0 3px rgba(59,158,222,0.2); }
    50%      { box-shadow: 0 0 0 6px rgba(59,158,222,0.1); }
  }

  .step-line {
    width: 24px; height: 1px;
    background: var(--border);
    transition: background 0.4s;
  }

  .step-line.active { background: linear-gradient(90deg, var(--blue-light), var(--green-light)); }

  /* â”€â”€ Footer â”€â”€ */
  .footer {
    text-align: center;
    margin-top: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
  }

  .footer-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    padding: 5px 12px;
    background: var(--white);
    border: 1px solid var(--border);
    border-radius: 20px;
    font-size: 11px;
    color: var(--text-soft);
    font-weight: 500;
    box-shadow: 0 1px 4px rgba(26,111,189,0.06);
  }

  .footer-badge .dot {
    width: 5px; height: 5px;
    border-radius: 50%;
    background: var(--green-mid);
    animation: dotPulse 2s ease-in-out infinite;
  }

  /* â”€â”€ Floating Particles â”€â”€ */
  .particles {
    position: fixed;
    inset: 0;
    z-index: 0;
    pointer-events: none;
    overflow: hidden;
  }

  .particle {
    position: absolute;
    border-radius: 50%;
    opacity: 0;
    animation: particleFloat linear infinite;
  }

  @keyframes particleFloat {
    0%   { transform: translateY(100vh) scale(0); opacity: 0; }
    10%  { opacity: 1; }
    90%  { opacity: 0.6; }
    100% { transform: translateY(-10vh) scale(1); opacity: 0; }
  }

  @media (max-width: 540px) {
    .card { padding: 40px 24px 36px; }
    h1 { font-size: 23px; }
    .card::before { left: 24px; right: 24px; }
  }
</style>
</head>
<body>

<!-- Background -->
<div class="bg-canvas">
  <div class="bg-orb bg-orb-1"></div>
  <div class="bg-orb bg-orb-2"></div>
  <div class="bg-orb bg-orb-3"></div>
</div>
<div class="bg-grid"></div>
<div class="particles" id="particles"></div>

<!-- Main Card -->
<div class="card">

  <!-- Header -->
  <div class="header">
    <div class="logo-wrap">
      <svg class="logo-svg" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="6" y="4" width="20" height="26" rx="3" fill="rgba(255,255,255,0.25)" stroke="rgba(255,255,255,0.6)" stroke-width="1.5"/>
        <rect x="10" y="4" width="18" height="26" rx="3" fill="rgba(255,255,255,0.15)" stroke="rgba(255,255,255,0.5)" stroke-width="1.5"/>
        <path d="M19 12v10M15 18l4 4 4-4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <rect x="13" y="26" width="12" height="2" rx="1" fill="white" opacity="0.7"/>
      </svg>
    </div>
    <h1>File Download Portal</h1>
    <p class="subtitle">Enter your model number to instantly<br>access and download your file</p>
  </div>

  <!-- Status Steps -->
  <div class="steps" id="steps">
    <div class="step active" id="step1">
      <div class="step-dot"></div>
      <span>Enter</span>
    </div>
    <div class="step-line" id="line1"></div>
    <div class="step" id="step2">
      <div class="step-dot"></div>
      <span>Search</span>
    </div>
    <div class="step-line" id="line2"></div>
    <div class="step" id="step3">
      <div class="step-dot"></div>
      <span>Download</span>
    </div>
  </div>

  <div class="divider" style="margin-top:24px;"></div>

  <!-- Model Number Input -->
  <div class="form-group">
    <label>
      <span class="label-dot"></span>
      Model Number
    </label>
    <div class="input-wrap">
      <span class="input-icon">
        <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
          <rect x="2" y="3" width="14" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
          <path d="M5 7h3M5 10h8M10 7h3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </span>
      <input
        type="text"
        id="modelNumber"
        placeholder="e.g.  AB15"
        onkeydown="if(event.key==='Enter') searchFile()"
        oninput="onInputChange()"
        autocomplete="off"
        autocapitalize="characters"
        spellcheck="false"
      >
    </div>
  </div>

  <button class="btn" onclick="searchFile()" id="searchBtn">
    <span class="spinner" id="spinner"></span>
    <span id="btnIcon">
      <svg width="17" height="17" viewBox="0 0 17 17" fill="none">
        <circle cx="7.5" cy="7.5" r="5" stroke="white" stroke-width="1.8"/>
        <path d="M11 11l3.5 3.5" stroke="white" stroke-width="1.8" stroke-linecap="round"/>
      </svg>
    </span>
    <span id="btnText">Search & Download</span>
  </button>

  <!-- Notifications -->
  <div class="notif error"   id="errorMsg"></div>
  <div class="notif success" id="successMsg"></div>

  <!-- Download Card -->
  <div class="dl-card" id="dlCard">
    <div class="file-badge">ğŸ“„</div>
    <div class="dl-file-name" id="dlFileName"></div>
    <div class="dl-file-sub">File found â€” your download has started</div>
    <a class="btn-dl" id="dlLink" href="#" target="_blank">
      <svg width="15" height="15" viewBox="0 0 15 15" fill="none">
        <path d="M7.5 2v8M4 7l3.5 3.5L11 7" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M2 12h11" stroke="white" stroke-width="1.8" stroke-linecap="round"/>
      </svg>
      Download File
    </a>
  </div>

  <!-- Footer -->
  <div class="footer">
    <div class="footer-badge">
      <span class="dot"></span>
      Secure Portal
    </div>
    <div class="footer-badge">
      <svg width="10" height="10" viewBox="0 0 10 10" fill="none">
        <rect x="1" y="4" width="8" height="6" rx="1" stroke="currentColor" stroke-width="1.2"/>
        <path d="M3 4V3a2 2 0 014 0v1" stroke="currentColor" stroke-width="1.2" stroke-linecap="round"/>
      </svg>
      Encrypted
    </div>
  </div>

</div>

<script>
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // ğŸ”´ PASTE YOUR APPS SCRIPT WEB APP URL HERE
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxstAEBhIKHD6hlGBGbPMLXwn7Pr535b7dhtvWG_B1EgNvuYz9J-KgHeC704wD3FqEf/exec";

  // â”€â”€ Floating Particles â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  (function createParticles() {
    const container = document.getElementById('particles');
    const colors = ['#3b9ede','#2dd4a0','#1a6fbd','#1aa876','#a8d8f0'];
    for (let i = 0; i < 18; i++) {
      const p = document.createElement('div');
      p.className = 'particle';
      const size = Math.random() * 6 + 3;
      p.style.cssText = `
        width:${size}px; height:${size}px;
        left:${Math.random()*100}%;
        background:${colors[Math.floor(Math.random()*colors.length)]};
        animation-duration:${Math.random()*15+10}s;
        animation-delay:${Math.random()*10}s;
        opacity:0;
      `;
      container.appendChild(p);
    }
  })();

  // â”€â”€ Step Progress â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function setStep(n) {
    const steps = [
      document.getElementById('step1'),
      document.getElementById('step2'),
      document.getElementById('step3')
    ];
    const lines = [
      document.getElementById('line1'),
      document.getElementById('line2')
    ];
    steps.forEach((s, i) => {
      s.classList.remove('active','done');
      if (i < n - 1)      s.classList.add('done');
      else if (i === n-1) s.classList.add('active');
    });
    lines.forEach((l, i) => {
      l.classList.toggle('active', i < n - 1);
    });
  }

  // â”€â”€ Device Info â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function getDeviceInfo() {
    const ua = navigator.userAgent;
    let browser = "Unknown", browserVersion = "Unknown";
    const browsers = [
      { name: "Edge",    rx: /Edg\/([0-9.]+)/ },
      { name: "Chrome",  rx: /Chrome\/([0-9.]+)/ },
      { name: "Firefox", rx: /Firefox\/([0-9.]+)/ },
      { name: "Safari",  rx: /Version\/([0-9.]+).*Safari/ },
      { name: "Opera",   rx: /OPR\/([0-9.]+)/ },
    ];
    for (const b of browsers) {
      const m = ua.match(b.rx);
      if (m) { browser = b.name; browserVersion = m[1]; break; }
    }
    let os = "Unknown";
    if      (/Windows NT 10/.test(ua))        os = "Windows 10/11";
    else if (/Windows NT 6/.test(ua))         os = "Windows 7/8";
    else if (/Mac OS X/.test(ua))             os = "macOS";
    else if (/Android ([0-9.]+)/.test(ua))    os = "Android " + ua.match(/Android ([0-9.]+)/)[1];
    else if (/iPhone|iPad/.test(ua))          os = "iOS";
    else if (/Linux/.test(ua))                os = "Linux";
    let deviceType = "Desktop";
    if      (/Mobi|Android|iPhone/.test(ua))  deviceType = "Mobile";
    else if (/iPad|Tablet/.test(ua))          deviceType = "Tablet";
    return { browser, browserVersion, os, deviceType,
      screenResolution: `${screen.width}x${screen.height}`,
      language: navigator.language || "Unknown",
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || "Unknown"
    };
  }

  // â”€â”€ UI Helpers â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  function onInputChange() {
    const val = document.getElementById('modelNumber').value;
    document.getElementById('modelNumber').classList.remove('error-state');
    document.getElementById('errorMsg').style.display = 'none';
    if (val.length > 0) setStep(1);
  }

  function setLoading(on) {
    document.getElementById('spinner').style.display  = on ? 'block' : 'none';
    document.getElementById('btnIcon').style.display  = on ? 'none'  : 'block';
    document.getElementById('btnText').textContent    = on ? 'Searchingâ€¦' : 'Search & Download';
    document.getElementById('searchBtn').disabled     = on;
    if (on) setStep(2);
  }

  function showError(msg) {
    const el = document.getElementById('errorMsg');
    el.innerHTML     = 'âš ï¸ &nbsp;' + msg;
    el.style.display = 'block';
    document.getElementById('successMsg').style.display = 'none';
    document.getElementById('dlCard').style.display     = 'none';
    document.getElementById('modelNumber').classList.add('error-state');
    setStep(1);

    // Shake animation
    const input = document.getElementById('modelNumber');
    input.style.animation = 'none';
    input.offsetHeight;
    input.style.animation = 'shake 0.4s ease';
  }

  function showSuccess(data) {
    document.getElementById('errorMsg').style.display = 'none';
    document.getElementById('modelNumber').classList.remove('error-state');

    document.getElementById('successMsg').innerHTML =
      `âœ… &nbsp;<strong>${data.modelNumber}</strong> found â€” download started!`;
    document.getElementById('successMsg').style.display = 'block';

    document.getElementById('dlFileName').textContent = data.fileName;
    document.getElementById('dlLink').href            = data.url;
    document.getElementById('dlCard').style.display   = 'block';
    setStep(3);

    window.open(data.url, '_blank');
  }

  // â”€â”€ Main Search â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  async function searchFile() {
    const model = document.getElementById('modelNumber').value.trim().toUpperCase();
    if (!model) { showError('Please enter a model number.'); return; }

    setLoading(true);
    const d = getDeviceInfo();

    const params = new URLSearchParams({
      action: "search", model,
      browser: d.browser, browserVersion: d.browserVersion,
      os: d.os, deviceType: d.deviceType,
      screen: d.screenResolution, language: d.language, timezone: d.timezone
    });

    try {
      const res  = await fetch(`${APPS_SCRIPT_URL}?${params.toString()}`, { method: "GET", redirect: "follow" });
      const data = await res.json();
      setLoading(false);
      data.success ? showSuccess(data) : showError(data.error);
    } catch (err) {
      setLoading(false);
      showError('Connection error. Please try again.');
    }
  }

  // Shake keyframes injected via JS
  const style = document.createElement('style');
  style.textContent = `
    @keyframes shake {
      0%,100% { transform: translateX(0); }
      20%      { transform: translateX(-8px); }
      40%      { transform: translateX(8px); }
      60%      { transform: translateX(-5px); }
      80%      { transform: translateX(5px); }
    }
  `;
  document.head.appendChild(style);
</script>

</body>
</html>